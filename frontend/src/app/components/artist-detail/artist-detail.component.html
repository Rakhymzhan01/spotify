<div class="container mt-4">
    <div *ngIf="loading" class="text-center my-5">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
  
    <div *ngIf="error" class="alert alert-danger">
      {{ error }}
    </div>
  
    <div *ngIf="!loading && !error && artist">
      <!-- Artist Header -->
      <div class="row mb-5">
        <div class="col-md-4">
          <img [src]="artist.image_url || 'https://via.placeholder.com/400'" class="img-fluid rounded" alt="{{ artist.name }}">
        </div>
        <div class="col-md-8">
          <h1 class="mb-3">{{ artist.name }}</h1>
          <p class="lead" *ngIf="artist.bio">{{ artist.bio }}</p>
          <a routerLink="/artists" class="btn btn-outline-secondary">&laquo; Back to Artists</a>
        </div>
      </div>
  
      <!-- Albums -->
      <h2 class="mb-4">Albums</h2>
      <div *ngIf="albums.length === 0" class="alert alert-info">
        No albums found for this artist.
      </div>
  
      <div *ngFor="let album of albums" class="mb-5">
        <div class="album-header d-flex align-items-center mb-3">
          <div class="me-3">
            <img [src]="album.cover_image_url || 'https://via.placeholder.com/100'" class="img-fluid" style="width: 100px; height: 100px;" alt="{{ album.title }}">
          </div>
          <div>
            <h3 class="mb-0">{{ album.title }}</h3>
            <p>Released: {{ album.release_date | date }}</p>
            <a [routerLink]="['/albums', album.id]" class="btn btn-sm btn-outline-primary">View Album Details</a>
          </div>
        </div>
        
        <!-- Tracks List -->
        <div class="tracks-container">
          <h4>Tracks</h4>
          <div *ngIf="!albumTracks[album.id] || albumTracks[album.id].length === 0" class="alert alert-info">
            No tracks available for this album.
          </div>
          <table class="table table-hover" *ngIf="albumTracks[album.id] && albumTracks[album.id].length > 0">
            <thead>
              <tr>
                <th>#</th>
                <th>Title</th>
                <th>Duration</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let track of albumTracks[album.id]">
                <td>{{ track.track_number }}</td>
                <td>{{ track.title }}</td>
                <td>{{ formatDuration(track.duration) }}</td>
                <td>
                  <!-- Play Button -->
                  <button class="btn btn-sm btn-success me-2" (click)="playTrack(track)" [disabled]="!track.audio_file">
                    <i class="bi bi-play-fill"></i> Play
                  </button>
                  
                  <!-- Add to Playlist Button -->
                  <div class="dropdown d-inline-block" *ngIf="(isAuthenticated$ | async)">
                    <button class="btn btn-sm btn-outline-primary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                      Add to Playlist
                    </button>
                    <ul class="dropdown-menu">
                      <li *ngIf="playlists.length === 0"><a class="dropdown-item disabled" href="#">No playlists</a></li>
                      <li *ngFor="let playlist of playlists">
                        <a class="dropdown-item" href="javascript:void(0)" (click)="addToPlaylist(track.id, playlist.id)">{{ playlist.title }}</a>
                      </li>
                    </ul>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>